Date              = Fri Aug 23 14:28:34 EDT 2024
Hostname          = c0909a-s35
Working Directory = /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366

Number of Nodes Allocated      = 1
Number of Tasks Allocated      = 1
Number of Cores/Task Allocated = 1
GPU Driver '550' detected

The following have been reloaded with a version change:
  1) gcc/7.3.0 => gcc/9.3.0

using python: /blue/roitberg/apps/torch1121/bin/python
{'allow_tf32': False,
 'ani_aev': 'cuaev',
 'ani_model_file': '/blue/roitberg/apps/lammps-ani/tests/ani1x_nr.pt',
 'ani_neighbor': 'full',
 'ani_num_models': 8,
 'ani_precision': 'single',
 'data_file': '/red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/frame_196366.data',
 'input_file': '/red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/in.22M.quench.lammps',
 'kokkos': True,
 'log_dir': '/red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/logs',
 'nsys': False,
 'num_gpus': 1,
 'replicate': '1 1 1',
 'run': True,
 'run_name': 'early_earth_22M_196366_quench',
 'run_steps': 1000,
 'timestep': 0.25}
Run with command:
LAMMPS_ANI_PROFILING=1 mpirun -np 1 /blue/roitberg/apps/lammps-ani/external/lammps/build/lmp_mpi -var data_file /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/frame_196366.data -var timestep 0.25 -var run_steps 1000 -var log_dir /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/logs -var replicate '1 1 1' -var ani_model_file /blue/roitberg/apps/lammps-ani/tests/ani1x_nr.pt -var ani_num_models 8 -var ani_aev cuaev -var ani_neighbor full -var ani_precision single -var newton_pair on -var ani_device cuda -var timestamp 2024-08-23-142838.166258 -k on g 1 -sf kk -pk kokkos gpu/aware on -in /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/in.22M.quench.lammps -log /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/logs/2024-08-23-142838.166258-kokkos-models_8-gpus_1-frame_196366-early_earth_22M_196366_quench.log
LAMMPS (28 Mar 2023 - Development)
KOKKOS mode is enabled (src/KOKKOS/kokkos.cpp:106)
  will use up to 1 GPU(s) per node
Kokkos::OpenMP::initialize WARNING: OMP_PROC_BIND environment variable not set
  In general, for best performance with OpenMP 4.0 or better set OMP_PROC_BIND=spread and OMP_PLACES=threads
  For best performance with OpenMP 3.1 set OMP_PROC_BIND=true
  For unit testing set OMP_PROC_BIND=false
  using 1 OpenMP thread(s) per MPI task
Loaded 1 plugins from /blue/roitberg/apps/lammps-ani/build/
Reading data file ...
  triclinic box = (0 0 0) to (557 557 557) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  22800000 atoms
  read_data CPU = 182.380 seconds
Replication is creating a 1x1x1 = 1 times larger system...
  triclinic box = (0 0 0) to (557 557 557) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  22800000 atoms
  replicate CPU = 5.696 seconds
Changing box ...
LAMMPS_ANI_PROFILING mode: 1
[W ___torch_mangle_16.py:260] Warning: Forcing virial_flag as False because CUAEV currently does not support virial/stress/pressure calculations (function )
Successfully loaded the model 
file: '/blue/roitberg/apps/lammps-ani/tests/ani1x_nr.pt' 
device: cuda:0 
dtype: float (FP32) 
nbrlist: full 
ani_aev: cuaev 
use_num_models: 8/8

System init for write_data ...
Generated 0 of 21 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.1
  ghost atom cutoff = 7.1
  binsize = 7.1, bins = 79 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair ani/kk, perpetual
      attributes: full, newton on, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
System init for write_restart ...
Generated 0 of 21 mixed pair_coeff terms from geometric mixing rule
Generated 0 of 21 mixed pair_coeff terms from geometric mixing rule
Setting up Verlet run ...
  Unit style    : real
  Current step  : 0
  Time step     : 0.25
Exception: nonzero is not supported for tensors with more than INT_MAX elements,   file a support request
Exception raised from nonzero_out_cuda at /opt/conda/conda-bld/pytorch_1659484683044/work/aten/src/ATen/native/cuda/Nonzero.cu:115 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14bab40df497 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x68 (0x14bab40b6d5d in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #2: at::native::nonzero_out_cuda(at::Tensor const&, at::Tensor&) + 0x71f (0x14ba0aef781f in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #3: at::native::nonzero_cuda(at::Tensor const&) + 0x239 (0x14ba0aef7b29 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #4: <unknown function> + 0x2b29d40 (0x14ba0bcbbd40 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #5: <unknown function> + 0x2b29dad (0x14ba0bcbbdad in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #6: at::_ops::nonzero::call(at::Tensor const&) + 0xa4 (0x14ba382667a4 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0x178bca0 (0x14ba37ebeca0 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #8: at::native::index_out(at::Tensor&, at::Tensor const&, c10::List<c10::optional<at::Tensor> > const&) + 0x1bb (0x14ba37ec0adb in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x2daaa0a (0x14ba0bf3ca0a in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #10: at::native::masked_select_cuda(at::Tensor const&, at::Tensor const&) + 0x116 (0x14ba0bf3d1d6 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #11: <unknown function> + 0x2b3a900 (0x14ba0bccc900 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #12: <unknown function> + 0x2b3a970 (0x14ba0bccc970 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cu.so)
frame #13: at::_ops::masked_select::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&) + 0x6c (0x14ba38484d0c in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x31ff2ff (0x14ba399322ff in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x31ff903 (0x14ba39932903 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #16: at::_ops::masked_select::call(at::Tensor const&, at::Tensor const&) + 0xc4 (0x14ba384cfea4 in /blue/roitberg/apps/torch1121/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor::masked_select(at::Tensor const&) const + 0x2b (0x14bab41a004d in /blue/roitberg/apps/lammps-ani/build/ani_plugin.so)
frame #18: LAMMPS_NS::PairANIKokkos<Kokkos::Cuda>::compute(int, int) + 0x11f2 (0x14bab41a361a in /blue/roitberg/apps/lammps-ani/build/ani_plugin.so)
frame #19: LAMMPS_NS::VerletKokkos::setup(int) + 0x69e (0x14bb1b93c880 in /blue/roitberg/apps/lammps-ani/external/lammps/build/liblammps_mpi.so.0)
frame #20: LAMMPS_NS::Run::command(int, char**) + 0x16ab (0x14bb1a984285 in /blue/roitberg/apps/lammps-ani/external/lammps/build/liblammps_mpi.so.0)
frame #21: LAMMPS_NS::Input::execute_command() + 0x10b5 (0x14bb1a73edb1 in /blue/roitberg/apps/lammps-ani/external/lammps/build/liblammps_mpi.so.0)
frame #22: LAMMPS_NS::Input::file() + 0x46b (0x14bb1a73b763 in /blue/roitberg/apps/lammps-ani/external/lammps/build/liblammps_mpi.so.0)
frame #23: /blue/roitberg/apps/lammps-ani/external/lammps/build/lmp_mpi() [0x40128b]
frame #24: __libc_start_main + 0xe5 (0x14bb16f00d85 in /lib64/libc.so.6)
frame #25: /blue/roitberg/apps/lammps-ani/external/lammps/build/lmp_mpi() [0x40115e]

--------------------------------------------------------------------------
MPI_ABORT was invoked on rank 0 in communicator MPI_COMM_WORLD
with errorcode 1.

NOTE: invoking MPI_ABORT causes Open MPI to kill all MPI processes.
You may or may not see output from other processes, depending on
exactly when Open MPI kills them.
--------------------------------------------------------------------------
Error occurred while running LAMMPS: Command 'LAMMPS_ANI_PROFILING=1 mpirun -np 1 /blue/roitberg/apps/lammps-ani/external/lammps/build/lmp_mpi -var data_file /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/frame_196366.data -var timestep 0.25 -var run_steps 1000 -var log_dir /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/logs -var replicate '1 1 1' -var ani_model_file /blue/roitberg/apps/lammps-ani/tests/ani1x_nr.pt -var ani_num_models 8 -var ani_aev cuaev -var ani_neighbor full -var ani_precision single -var newton_pair on -var ani_device cuda -var timestamp 2024-08-23-142838.166258 -k on g 1 -sf kk -pk kokkos gpu/aware on -in /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/in.22M.quench.lammps -log /red/roitberg/nick_analysis/Restart/22.8M_atoms/frame_196366/logs/2024-08-23-142838.166258-kokkos-models_8-gpus_1-frame_196366-early_earth_22M_196366_quench.log' returned non-zero exit status 1.
